@model WebApplication1.Controllers.TestResultsViewModel
@{
    ViewData["Title"] = "Результаты теста";
}

<div class="content-box text-center">
    <h1 class="display-4 mb-4">Результаты теста</h1>
    
    <div class="result-summary mb-5">
        <h2 class="mb-3">Правильных ответов: @Model.CorrectAnswers из @Model.TotalQuestions</h2>
        <div class="progress" style="height: 30px;">
            <div class="progress-bar @(Model.CorrectAnswers >= Model.TotalQuestions / 2 ? "bg-success" : "bg-danger")" 
                 role="progressbar" 
                 style="width: @((Model.CorrectAnswers * 100) / Model.TotalQuestions)%">
                @((Model.CorrectAnswers * 100) / Model.TotalQuestions)%
            </div>
        </div>
    </div>

    <div class="questions-review">
        @foreach (var question in Model.Questions)
        {
            <div class="question-review mb-4 p-4 border rounded shadow-sm">
                <h4 class="mb-3">@question.Question</h4>
                <div class="options-review">
                    @for (int i = 0; i < question.Options.Length; i++)
                    {
                        var isCorrect = i == question.CorrectAnswerIndex;
                        var isUserAnswer = Model.UserAnswers.TryGetValue(question.Id, out var userAnswer) && userAnswer == i;
                        var optionClass = isCorrect ? "text-success" : (isUserAnswer ? "text-danger" : "");
                        var textColorStyle = string.IsNullOrEmpty(optionClass) ? "color: #212529;" : "";
                        
                        <div class="option-review p-2 mb-2 @optionClass" 
                             style="border: 1px solid #dee2e6; border-radius: 4px; @textColorStyle">
                            @if (isCorrect)
                            {
                                <i class="fas fa-check-circle me-2"></i>
                            }
                            else if (isUserAnswer)
                            {
                                <i class="fas fa-times-circle me-2"></i>
                            }
                            @question.Options[i]
                        </div>
                    }
                </div>
            </div>
        }
    </div>

    <div class="mt-5">
        <a href="@Url.Action("Index")" class="btn btn-primary btn-lg">
            <i class="fas fa-redo me-2"></i>Начать тест заново
        </a>
    </div>
</div>

<style>
    .option-review {
        transition: all 0.3s ease;
        color: #212529 !important;
    }
    
    .option-review:hover {
        background-color: #f8f9fa;
    }
    
    .text-success {
        color: #198754 !important;
        background-color: rgba(25, 135, 84, 0.1);
    }
    
    .text-danger {
        color: #dc3545 !important;
        background-color: rgba(220, 53, 69, 0.1);
    }
    
    .question-review {
        background-color: #fff;
        transition: all 0.3s ease;
        color: #212529 !important;
    }
    
    .question-review:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1) !important;
    }
    
    .question-review h4 {
        color: #212529 !important;
    }
</style> 